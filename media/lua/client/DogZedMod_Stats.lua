--[[██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                        				 Custom  PZ  Mod  Developer  for  Hire													  |
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                       	Portfolio:  https://steamcommunity.com/id/glytch3r/myworkshopfiles/							          |
|                       		                                    														 	  |
|                       	Discord:    Glytch3r#1337 / glytch3r															      |
|                       		                                    														 	  |
|                       	Support:    https://ko-fi.com/glytch3r														    	  |
|_______________________________________________________________________________________________________________________________-]]
--[[_____________________________________________________________________________________________________________________________
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████--]]


DogZedMod = DogZedMod or {}

------------------------               ---------------------------
function DogZedMod.doRoll(percent) if percent >= ZombRand(1, 101) then return true end return false end
-----------------------            ---------------------------


function DogZedMod.TempMarker(sq, isGood)
	if not sq then return end
	local r, g, b = 1,0.4,0.4
	if isGood then
		r, g, b = 0.4,0.4,1
	end
	local mark = getWorldMarkers():addGridSquareMarker("circle_center", "circle_only_highlight", sq,r,g,b, true, 0.5)
	TestMarkers.add(mark);
	timer:Simple(sec, function()
		mark:remove()
	end)
end


function DogZedMod.TicksSinceSeenZombie()
    local pl = getPlayer()
    return pl.TicksSinceSeenZombie >= 6000
end
function DogZedMod.lastSeenZombieTime()
    local pl = getPlayer()
    return pl.lastSeenZombieTime >= 6000
end
--[[
print(zed:getVariableString("AttackDidDamage"))
print(zed:getVariableString("ZombieBiteDone"))
 ]]
function DogZedMod.isBiteReact(pl)
	local attacker = nil
	if pl:getVariableString("HitReaction") == "Bite" then
		local time = pl:timeSinceLastStab()
		print(time)
		attacker = pl:getVariableString("getLastTargettedBy")

		return true
	end
	return false
end
--[[
print(zed:getVariableString("AttackDidDamage"))
print(zed:getVariableString("bAttack"))
 ]]

function DogZedMod.isDogPl(pl)
	if not pl then return false end
	if not instanceof(pl, "IsoPlayer") then return false end
	local wornItems = pl:getWornItems()
	if wornItems then
		for i=1, wornItems:size() do
			local item = wornItems:get(i-1):getItem()
			if item:getFullType() == DogZedMod.skin0 or item:getFullType() == DogZedMod.skin1 or item:getFullType() == DogZedMod.skin2 then
				return true
			end
		end
	end
	return false
end

-----------------------            ---------------------------






--[[
local function getFieldVar(o, fname)
  for i = 0, getNumClassFields(o) - 1 do
    local f = getClassField(o, i)
    if tostring(f) == fname then
      return f
    end
  end
end
local cognition = getFieldVar(self.dbgZed, "public int zombie.characters.IsoZombie.cognition")
local speedType = getFieldVar(self.dbgZed, "public int zombie.characters.IsoZombie.speedType")
strength
 ]]


function DogZedMod.setStats(zed)
    if zed and DogZedMod.isDogZed(zed) then
        if zed:getModData()['DogZed_Init'] == nil then

			local sandOpt = getSandboxOptions()
			--local zSpeed = sandOpt:getOptionByName("ZombieLore.Speed"):getValue()

			local zCog = sandOpt:getOptionByName("ZombieLore.Cognition"):getValue()
			local zTough = sandOpt:getOptionByName("ZombieLore.Toughness"):getValue()
			local zStr = sandOpt:getOptionByName("ZombieLore.Strength"):getValue()

			local zMem = sandOpt:getOptionByName("ZombieLore.Memory"):getValue()
			local zSee = sandOpt:getOptionByName("ZombieLore.Sight"):getValue()
			local zHear = sandOpt:getOptionByName("ZombieLore.Hearing"):getValue()

			-----------------------            ---------------------------

			--sandOpt:set("ZombieLore.Speed", 2) 		-- 1 sprinters  		2 fast shamblers  	3 shamblers 		4 random

			sandOpt:set("ZombieLore.Strength",2)  	-- 1 superhuman 		2 normal 			3 weak 				4 random
			sandOpt:set("ZombieLore.Toughness",2)	-- 1 tough 				2 normal 			3 fragile 			4 random
			sandOpt:set("ZombieLore.Cognition",3) 	-- 1 navigate + doors 	2 navigate 			3 basic navigation 	4 random

			sandOpt:set("ZombieLore.Memory",2) 		 --1 long 				2 normal 			3 short				4 none 			5 random
			sandOpt:set("ZombieLore.Sight",2) 		-- 1 eagle 				2 normal 			3 poor 				4 random
			sandOpt:set("ZombieLore.Hearing",2) 	-- 1 pinpoint 			2 normal 			3 poor 				4 random

            -----------------------            ---------------------------
			local tSpeed =  SandboxVars.DogZedMod.TurnSpeed or 1.5
			DogZedMod.setTurnSpeed(zed, tSpeed)
            -----------------------            ---------------------------

            zed:getModData()['DogZed_Init'] = true
            zed:setVariable('isDogZed', 'true')
            -----------------------            ---------------------------

			if DogZedMod.isTagEmpty(zed) then
				DogZedMod.setTag(zed)
			end

            zed:makeInactive(true);
            zed:makeInactive(false);
            zed:DoZombieStats()

			--sandOpt:set("ZombieLore.Speed", zSpeed)

            sandOpt:set("ZombieLore.Cognition", zCog)
            sandOpt:set("ZombieLore.Toughness", zTough)
            sandOpt:set("ZombieLore.Strength", zStr)

            sandOpt:set("ZombieLore.Memory", zMem)
            sandOpt:set("ZombieLore.Sight", zSee)
            sandOpt:set("ZombieLore.Hearing", zHear)
            --getSandboxOptions():toLua()

            if not DogZedMod.isCrawler(zed) then
                DogZedMod.setCrawler(zed)
            end

        end
    end
end

-----------------------            ---------------------------



function DogZedMod.setStatsToAll()
    local zombies = getCell():getZombieList()
    if not getCell() or not zombies then return end
    for i = 0, zombies:size() - 1 do
        local zed = zombies:get(i)
        if zed and DogZedMod.isDogZed(zed) then
			local num = DogZedMod.getDayTimeInt()
            DogZedMod.setTag(zed, num)
            if zed:getModData()['DogZed_Init'] ~= nil then
				DogZedMod.setStats(zed)
            end
        end
    end
end
--------------
function DogZedMod.isUnarmed(pl, wpn)
	return (tostring(WeaponType.getWeaponType(pl)) == 'barehand' or (wpn and wpn:getCategories():contains("Unarmed"))) or wpn == nil
end
function DogZedMod.isFirearm(pl, wpn)
	if not wpn then return false end
	if wpn:isAimedFirearm() then return true end
	if DogZedMod.isUnarmed(pl, wpn) then return false end
	return wpn:getScriptItem() and wpn:getScriptItem():isRanged()
end
---------            ---------------------------

function DogZedMod.getCol(int)
    local defaultColor = { r=1, g=1, b=1 }
    if not int then return defaultColor end

    local colors = {

        [1] = { r=1, g=0, b=0 },     -- Red
        [2] = { r=1, g=0.5, b=0 },   -- Orange
        [3] = { r=1, g=1, b=0 },     -- Yellow
        [4] = { r=0, g=1, b=0 },     -- Green
        [5] = { r=0, g=0, b=1 },     -- Blue
        [6] = { r=0.29, g=0, b=0.51 }, -- Indigo
        [7] = { r=0.56, g=0, b=1 },  -- Violet
        [8] = { r=1, g=1, b=1 },      -- White
        [9] = { r=0, g=0, b=0 },     -- Black
    }

    return colors[int] or defaultColor
end


-----------------------               ------------------------------



-----------------------            ---------------------------

